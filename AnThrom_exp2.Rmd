---
title: "Exploring the relationship between anthropomorphism and Theory-of-Mind in brain and behaviour: Experiment 2"
author: Ruud Hortensius and Michaela Kent
output:
  html_notebook:
    number_sections: no
    theme: default
    toc: yes
    toc_float: yes
    code_folding: show
  html_document:
    df_print: paged
    toc: yes
    toc_float: yes
    code_folding: show
editor_options: 
  chunk_output_type: inline
---
Testing the relationship between situational and dispositional anthropomorphism and Theory-of-Mind   
June 2020 - July 2020

# 1. Details {.tabset .tabset-fade .tabset-pills}

## 1.1 Preregistration
The preregistration can be found here:

## 1.2 Libraries
```{r, message=FALSE}
source("R_rainclouds.R") 
source("summarySE.R")
library(psych)
library(patchwork)
library(tidyverse)
library(ordinal)
library(brms)
options(mc.cores = parallel::detectCores()) 
theme_set(theme_classic(base_size = 10)) 
options("scipen"=10, "digits"=4) 
```

## 1.3 Data description
[short description]

# 2. Load the data {.tabset .tabset-fade .tabset-pills}
The data can be downloaded from the [OSF project page](https://osf.io/a8pyr/)

## 2.1 Load the prolific export file
```{r, echo = TRUE, message = FALSE}
DF.demo <- list.files("data/pilot",pattern="\\prolific*", full.names=TRUE) %>% 
  map_dfr(read_csv) %>% 
  rename(prolific_id = participant_id)
```

## 2.2 Load the psychopy/pavlovia files
```{r, echo = TRUE, message = FALSE}
DF.exp2 <- list.files("data/pilot",pattern="\\PARTICIPANT*", full.names=TRUE) %>% 
  map_dfr(read_csv)
events <- read_csv("/Users/rh/PsyCloud/Technician/1_AnThrom/Experiment_2/task/pilot/events_pilot.csv") #can be removed for main experiment, corrected in psychopy
```

## 2.3 Get the rating task data

-After each of the 16 “mental” or “pain” scenes, we will pause the film and will ask the participant to rate the extent to which they believe the characters of the film (a stork and a cloud) possess certain capacities. Participants rate if the character is able to “choose and control its own actions”, “be aware of itself and its thoughts and feelings”, “do what it wants”, and whether the character has “preferences and plans” and “feelings” on a scale from 1 (not at all) to 7 (very much). These items correspond to the definitions used by Waytz and colleagues (2010; 2018) for “free will”, “consciousness”, “a mind of its own”, “intentions”, and the “experience emotions”. 

-After each of the 16 “mental” or “pain” scenes, we will pause the film and participants will be asked to what extent they feel capable of “imagining what the cloud will do next” and “thinking about what the cloud is doing and why” on a scale from 1 (not at all) to 7 (very much). These items correspond to the definitions used for “understood the character” and “feel capable of predicting it’s future behaviour” in the study of Waytz, Morewedge and colleagues (2010).  A 7-point scale instead of a 10-point scale is used to allow for presentation alongside the situational anthropomorphism items. 

```{r}
DF.rating <- DF.exp2 %>%
  select("prolific_id", "eventnrM","event_typeM", "measure", "item", "focus", "key_resp_1.keys", "key_resp_2.keys", "key_resp_1.rt", "key_resp_2.rt")  %>%
  mutate_at(vars(-key_resp_1.keys, -key_resp_2.keys, -key_resp_1.rt, -key_resp_2.rt),as.factor) %>%
  mutate(response = coalesce(key_resp_1.keys, key_resp_2.keys)) %>%
  mutate(rt = coalesce(key_resp_1.rt, key_resp_2.rt)) %>%
  select(-key_resp_1.keys, -key_resp_2.keys,-key_resp_1.rt, -key_resp_2.rt) %>%
  filter(!is.na(response) & !is.na(focus)) %>%
  group_by(prolific_id) %>%
  mutate(trial_nr = c(1:length(response))) %>% #can be removed for main experiment, corrected in psychopy
  select(-event_typeM, -eventnrM) %>% #can be removed for main experiment, corrected in psychopy
  left_join(., events, by = "trial_nr") %>% #can be removed for main experiment, corrected in psychopy
  mutate_at(vars(-response, -rt),as.factor)
```

## 2.4 Get the IDAQ task data
Participants will be asked to complete the Individual Differences in Anthropomorphism Questionnaire (IDAQ; Waytz, Cacioppo, et al., 2010) at the end of the study. This questionnaire consists of 15 anthropomorphic items for which participants provide a rating on the extent that natural entities, non-human animals, and technological devices have “free will”, “consciousness”, “a mind of its own”, “intentions”, and can “experience emotions”. The questionnaire has 15 additional nonanthropomorphic items (IDAQ-NA) for which participants provide a rating of functional features of a stimulus (good-looking, active, useful, lethargic, durable; e.g. to what extent is the average camera lethargic?). Responses are rated on a scale from 0 (not at all) to 10 (very much). 

```{r}
DF.idaq <- DF.exp2 %>%
    select("prolific_id", "ItemNr", "Question", "Scale",  "idaq_s.rt" , "idaq_s.response", "idaqs.rt" , "idaqs.response", "key_resp_8.rt", "key_resp_12.rt") %>%
  mutate(idaq_resp = coalesce(idaq_s.response, idaqs.response)) %>%
  mutate(idaq_rt = coalesce(idaq_s.rt, idaqs.rt, key_resp_8.rt, key_resp_12.rt)) %>%
  filter(!is.na(idaq_rt)) %>%
  select(-idaq_s.rt, -idaq_s.response, -idaqs.rt, -idaqs.response, -key_resp_8.rt, -key_resp_12.rt)
```

## 2.5 Get the false belief task data
Participants will be asked to indicate if a short statement about the false-belief or false-photograph story is true (1) or false (2). 
```{r}
DF.fa <- DF.exp2 %>%
  select("prolific_id", "p_b", "trials_fb.thisIndex",  "key_resp_fb.keys" , "key_resp_fb.rt", "CorrectAns")  %>%
  rename(fa_resp = key_resp_fb.keys, item_number = trials_fb.thisIndex, rt = key_resp_fb.rt) %>%
  filter(!is.na(p_b)) %>%
  mutate(acc = ifelse(fa_resp == CorrectAns, 1, 0)) %>%
  mutate_at(vars(-acc, -rt),as.factor) 
```

## 2.5 Get the control data
After 4:02 minutes the film will be paused, and participants will be asked to describe in one or two sentences what they think will happen next (to a maximum of 2000 characters including spaces). This serves as an attention check and a future exploratory measure.

```{r}
DF.prediction <- DF.exp2 %>%
  select("prolific_id", "prediction", "key_resp_6.keys") %>%
  filter(!is.na(key_resp_6.keys)) %>%
  select(-key_resp_6.keys)
```

Participants will be asked to indicate if they have seen the film before (1-yes, 2-no).
```{r}
DF.seen <- DF.exp2 %>%
  select("prolific_id", "key_resp_seen.keys") %>%
  rename(seen = key_resp_seen.keys) %>%
  filter(!is.na(seen)) 
```

# 3. Sample {.tabset .tabset-fade .tabset-pills}

## 3.1 Number of approved participants
```{r}
DF.demo %>% 
  group_by(status) %>%
  tally() %>%
  knitr::kable(., caption = "Breakdown prolific")
```

## 3.2 Age
NB. This will be updated after data collection to account for structure of the representational sample 
```{r}
DF.demo %>% 
  filter(status == "APPROVED") %>% 
  summarise(mean = mean(age),
            SD = sd(age)) %>%
  knitr::kable(., caption = "Age")
```

## 3.3 Male/female
NB. This will be updated after data collection to account for structure of the representational sample 
```{r}
DF.demo %>% 
  filter(status == "APPROVED") %>% 
  group_by(Sex) %>%
  tally() %>%
  knitr::kable(., caption = "Sex")
```

# 4. Data exclusion {.tabset .tabset-fade .tabset-pills}
The following criteria are used to exclude participants:

## 4.1 Attention check:
Participants who fail the attention check, i.e. participant who do not make a prediction during the movie (no characters typed);

```{r}
excluded_participants <- DF.prediction %>% 
  filter(is.na(prediction)) %>% 
  select(prolific_id) %>% 
  mutate(reason = "attention_check")
```

## 4.2 No variability in ratings:
Participants who show no variability in their ratings across the event numbers of the film, i.e. a standard deviation of <0.5;

```{r}
DF.rating %>%
  group_by(prolific_id, measure) %>%
  summarise(ratingSD = sd(response)) %>%
  ggplot(., aes(x=measure, y=ratingSD, fill = measure)) +
  geom_point(aes(colour = measure), position=position_jitter(width = .02), size = 1, shape = 21, colour = "Black") +
  geom_boxplot(aes(x=measure,y=ratingSD),position=position_nudge(x = .1, y = 0),outlier.shape = NA, alpha = .5, width = .1, colour = "black") +
  geom_hline(yintercept = 0.5, color = "grey", linetype = 2) +
  annotate("text", x = 0.75, y = 0.6, label = "Preregistered exclusion criteria") +
  ylab("Standard deviation rating")+
  xlab("measure") +
  ggtitle("Variability of ratings during the rating task") +
  ylim(0,4)+
  scale_fill_manual(values=c("#0072B2", "#D55E00")) +
  theme(legend.position="none") 
```

Update the exclude participants list:
```{r}
excluded_participants <- DF.rating %>%
  group_by(prolific_id, measure) %>%
  summarise(ratingSD = sd(response)) %>%
  filter(ratingSD <= 0.5) %>%
  select(prolific_id) %>%
  mutate(reason = "variability_rating") %>%
  bind_rows(., excluded_participants)
```

## 4.3 Click through:
Participants who click through the rating task, i.e. with a mean response duration < 1sec:

```{r}
ctR <- DF.rating %>%
  group_by(prolific_id, measure) %>%
  summarise(rt = mean(rt)) %>%
  ggplot(., aes(x=measure, y=rt, fill = measure)) +
  geom_point(aes(colour = measure), position=position_jitter(width = .02), size = 1, shape = 21, colour = "Black") +
  geom_boxplot(aes(x=measure,y=rt),position=position_nudge(x = .1, y = 0),outlier.shape = NA, alpha = .5, width = .1, colour = "black") +
  geom_hline(yintercept = 1, color = "grey", linetype = 2) +
  annotate("text", x = 1.2, y = 1.15, label = "Preregistered exclusion criteria") +
  ylab("Mean reaction time")+
  xlab("measure") +
  ggtitle("Reaction time during the rating task") +
  scale_fill_manual(values=c("#0072B2", "#D55E00")) +
  theme(legend.position="none") 
```

Participants who click through the IDAQ questionnaire, i.e. with total duration of < 1min; 
```{r}
ctI <-DF.idaq %>%
  group_by(prolific_id) %>%
  summarise(total = sum(idaq_rt)) %>%
  ggplot(., aes(x=1, y=total, fill = "blue")) +
  geom_point(aes(colour = Scale), position=position_jitter(width = .001), size = 1, shape = 21, colour = "Black") +
  geom_boxplot(aes(x=1,y=total),position=position_nudge(x = .005, y = 0),outlier.shape = NA, alpha = .5, width = .005, colour = "black") +
  geom_hline(yintercept = 60, color = "grey", linetype = 2) +
  #annotate("text", x = 1.0002, y = 70, label = "Preregistered exclusion criteria") +
  ylab("Mean completion time (sec)")+
  ggtitle("IDAQ completion time") +
    scale_fill_manual(values=c("#0072B2", "#D55E00")) +
  theme(legend.position="none",     
        axis.text.x = element_blank(),     
        axis.ticks.x = element_blank(),
        axis.title.x = element_blank()) 
 
ctR + ctI
```

Update the exclude participants list (rating task):
```{r}
excluded_participants <- DF.rating %>%
  group_by(prolific_id, measure) %>%
  summarise(rt = mean(rt))  %>%
  filter(rt < 1) %>%
  select(prolific_id) %>%
  mutate(reason = "duration_rating") %>%
  bind_rows(., excluded_participants)
```

Update the exclude participants list (IDAQ):
```{r}
excluded_participants <- DF.idaq %>%
  group_by(prolific_id) %>%
  summarise(total = sum(idaq_rt))  %>%
  filter(total < 60) %>%
  select(prolific_id) %>%
  mutate(reason = "duration_idaq") %>%
  bind_rows(., excluded_participants)
```

## 4.4 Accuracy:
Participants who have an accuracy of 50% or lower for the false belief questions in the False Belief task;
```{r}
DF.fa %>%
  group_by(prolific_id, p_b) %>%
  summarise(acc = mean(acc)) %>%
  mutate_at(vars(-acc), as.factor) %>%
  ggplot(., aes(x=p_b, y=acc, fill = p_b)) +
  geom_point(aes(colour = p_b), position=position_jitter(width = .05), size = 1, shape = 21, colour = "Black") +
  geom_boxplot(aes(x=p_b,y=acc),position=position_nudge(x = .1, y = 0),outlier.shape = NA, alpha = .5, width = .1, colour = "black")+
  ylab("accuracy (p)")+
  xlab("belief (b) or photograph (p)") +
  geom_hline(yintercept = 0.5, color = "grey", linetype = 2) +
  annotate("text", x = 0.75, y = 0.53, label = "Preregistered exclusion criteria") +
  scale_fill_manual(values=c("#0072B2", "#D55E00")) +
  theme(legend.position="none") +
  ylim(0, 1.3)
```

Update the exclude participants list:
```{r}
excluded_participants <- DF.fa %>%
  group_by(prolific_id, p_b) %>%
  summarise(acc = mean(acc)) %>%
  filter(acc <= 0.5 & p_b == "b") %>%
  select(prolific_id) %>%
  mutate(reason = "fa_accuracy") %>%
  bind_rows(., excluded_participants)
```

## 4.5 Missing data: 
Participants who have 5 or more missing responses for the False Belief task will be excluded.
```{r}
DF.fa %>%
  group_by(prolific_id) %>%
  summarise(missing = sum(is.na(fa_resp)))%>%
  filter(missing >= 5) %>%
  select(prolific_id) %>%
  mutate(reason = "fa_missing") %>%
  bind_rows(., excluded_participants)
```

Participants who do not finish the task. The false belief task is either after the IDAQ and rating task or before the IDAQ.
```{r}
idaq_sub <- DF.idaq %>% select(prolific_id) %>% unique()
fa_sub <- DF.fa %>% select(prolific_id) %>% unique()

excluded_participants <- anti_join(idaq_sub, fa_sub, by = "prolific_id") %>%  mutate(reason = "incomplete") %>%
  bind_rows(., excluded_participants)
```

## 4.6 Excluded participants:
```{r}
excluded_participants %>%
  group_by(reason) %>% 
  tally() %>% 
  knitr::kable(., caption = "Excluded participants")
```

## 4.5 Update all the tasks 
```{r}
DF.demo <- DF.demo %>% filter(!prolific_id %in% excluded_participants$prolific_id)
DF.rating <- DF.rating %>% filter(!prolific_id %in% excluded_participants$prolific_id)
DF.prediction <- DF.prediction %>% filter(!prolific_id %in% excluded_participants$prolific_id)
DF.seen <- DF.seen %>% filter(!prolific_id %in% excluded_participants$prolific_id)
DF.fa <- DF.fa %>% filter(!prolific_id %in% excluded_participants$prolific_id) 
DF.idaq <- DF.idaq %>% filter(!prolific_id %in% excluded_participants$prolific_id)
```

# 5. Rating task analysis {.tabset .tabset-fade .tabset-pills} (Possibly change to data wrangling)
To check if anthropomorphism and effectance ratings during the film fluctuate over time (1-16), event type (mental or pain), and focus (cloud or stork), we will run two Bayesian multilevel ordinal regression models.

Model C1 - test if situational anthropomorphism ratings fluctuate over time, event, and focus.  
Model C2 - test if effectance ratings fluctuate over time, event, and focus.

The dependent variable is anthropomorphism ratings during the film (sitant) for model C1, effectance ratings during the film (effectance) for model C2, with event_type (mental or pain) and focus (cloud or stork) as independent variables. Random effects include participants (sub) and event_number (1-16) and slopes are specified maximally . We expect that anthropomorphism and effectance ratings fluctuate over time (event_number), as well as differ between event_type (mental > pain), but not between focus (cloud and stork). 

For these control models, we will specify cumulative ordinal, category-specific, and adjecent-category without category-specific effects, and unequal variances models (Bürkner & Vuorre, 2019).

## 5.1 Situational anthropomorphism  and effectance indices 
The 5 items will be averaged to create a situational anthropomorphism score (Waytz, Morewedge, et al., 2010). 
The 2 items will be averaged to create an effectance score (Waytz, Morewedge, et al., 2010). 
```{r}
order <- c("1", "2", "3", "4", "5", "6", "7", "8", "9", "10", "11", "12", "13", "14", "15", "16")  


DF.rating <- DF.rating %>% 
  dplyr::group_by(prolific_id, measure, focus, event_nrM, event_typeM) %>%
  dplyr::summarise(rating = mean(response)) %>%
  mutate(event_nrM = factor(event_nrM, levels=c(1:16), ordered=TRUE)) #add contrast coding?

  #mutate(event_nrM = v(event_nrM, order))


rating_summary <- summarySEwithin(DF.rating, measurevar="rating", withinvars= c("focus","measure", "event_typeM", "event_nrM"), idvar="prolific_id")

rating_summary %>% 
  knitr::kable(., caption = "Descriptive statistics rating task")
```

## 5.2 Visualisation 
```{r}
DF.rating %>%
  filter(measure == "anthropomorphism") %>% 
  ggplot(., aes(x = event_nrM, y = rating, colour = prolific_id)) +
#geom_line(show.legend=FALSE,alpha=0.5) +
  geom_line(data = rating_summary,  aes(event_nrM, rating), colour = "black", size = 2) +
  theme_classic() +
#  coord_fixed(ratio = 1/1) + 
  scale_colour_brewer(palette = "Blues") +
  #ylim(1,7)+
  facet_wrap(focus~event_typeM) +
  theme(
    axis.title.y = element_blank(),
    axis.title.x = element_blank()
  )
```


## 5.3 Preparation

Before fitting these control models, we will establish which link function we need to use (following the procedure outlined by Stadler, 2017).
```{r}
cumulativemodelfit <- function(formula, data, links=c("logit", "probit", "cloglog", "cauchit"),
    thresholds=c("flexible", "equidistant"), verbose=TRUE) {
  names(links) <- links
  names(thresholds) <- thresholds
  llks <- outer(links, thresholds,
    Vectorize(function(link, threshold)
      # catch error for responses with 2 levels
      tryCatch(ordinal::clm(formula, data=data, link=link, threshold=threshold)$logLik,
        error = function(e) NA)))
  print(llks)
  if (verbose) {
    bestfit <- which.max(llks)
    cat("\nThe best link function is ", links[bestfit %% length(links)], " with a ",
    thresholds[1 + bestfit %/% length(thresholds)], " threshold (logLik ", llks[bestfit],
    ")\n", sep="")
  }
  invisible(llks)
}
```


```{r}
cumulativemodelfit(rating ~ 1, data=DF.rating)
```

## 5.4 Priors
Weakly informative priors 
```{r}
#priors1 <- c(set_prior("normal(0,1)", class = "b"))
```

Indices:
Anthropomorphism:
•	Situational anthropomorphism: 
- The 5 items will be averaged to create a situational anthropomorphism score (Waytz, Morewedge, et al., 2010). 

•	Dispositional anthropomorphism:
We will sum the responses for the IDAQ and IDAQ-NA scale separately (Waytz, Cacioppo, et al., 2010). 

Theory-of-Mind:
•	Effectance:
The 2 items will be averaged to create an effectance score (Waytz, Morewedge, et al., 2010). 

•	False belief:
Accuracy (percentage correct) for the false-belief and false-photograph stories will be calculated separately (Spunt et al., 2015).

All anthropomorphism and Theory-of-Mind indices will be centered and scaled before analyses. For the multilevel ordinal regression models (C1-C2), the ratings will be ordered (1<2<3<4<5<6<7). 

## 5.2 Visualisation I 
```{r}
DF.rating %>%
  dplyr::group_by(prolific_id, measure, focus, event_typeM) %>%
  #dplyr::summarise(rating = mean(response)) %>%
  ggplot(., aes(x=event_typeM, y=rating, fill = focus)) +
  geom_point(aes(colour = event_typeM), position=position_jitter(width = .05), size = 1, shape = 21, colour = "Black") +
  geom_flat_violin(position=position_nudge(x = .2, y = 0),adjust =2, trim = FALSE, alpha = .75, colour = "Black") +
  geom_boxplot(aes(x=event_typeM,y=rating),position=position_nudge(x = .1, y = 0),outlier.shape = NA, alpha = .5, width = .1, colour = "black") +
  geom_point(data = rating_summary, aes(x = event_typeM, y = rating, fill = focus), position = position_nudge(.3), colour = "BLACK")+
  geom_errorbar(data = rating_summary, aes(x=event_typeM,y=rating, ymin = rating-ci, ymax = rating +ci), position=position_nudge(x = .3, y = 0), width = .05)+
  ylab("rating")+
  xlab("mental or pain") +
  scale_fill_manual(values=c("#0072B2", "#D55E00")) +
  #theme(legend.position="none") +
  facet_wrap(~measure)
```

# 6. Control analyses

## 6.1 Control analysis 1 - situational anthropomorphism

Model C1 - test if situational anthropomorphism ratings fluctuate over time, event, and focus:
```{r}
#DF.rating<-DF.rating %>% filter(measure == "anthropomorphism")

#priors1 <- c(set_prior("normal(0,1)", class = "b"))

#brm(
#  cent_sitant ~ 1 + event_type * focus +
#    (1 + event_type * focus | sub) + (1 + focus | event_number),   
#  data = DF.rating,  
#  family = cumulative("logit"),
#  priors = priors2,
#  file = modelC1.RDS)


```


## 6.2 Control analysis 2 - effectance

Model C2 - test if effectance ratings fluctuate over time, event, and focus:
```{r}
#brm(
#  cent_effectance ~ 1 + event_type + focus +
#    (1 + event_type * focus | sub) + (1 + focus | event_number),   
#  data = DF.rating,  
#  family = cumulative("logit"),
#  priors = priors2,
#  file = modelC2.RDS)
```


## 6.3 Control analysis 3 - dispositional anthropomorphism

Model C3 – test if dispositional anthropomorphism is positively related to situational anthropomorphism:
```{r}
brm(formula = cent_sitant ~ cent_disant, 
      data = DF.exp2,
      family = gaussian,
      priors = priors2,
      chains = 4,
      iter = 4000,
      seed = 42, 
      file = modelC3.RDS)

```

## 6.4 Control analysis 4 - false belief

Model C4 – test if false belief performance is positively related to effectance ratings:
```{r}
brm(formula = cent_effectance ~ cent_falsebelief, 
      data = DF.exp2,
      family = gaussian, 
      priors = priors2,
      chains = 4,
      iter = 4000,
      seed = 42, 
      file = modelC3.RDS)
```

# 7. Main analyses

Bayesian regression will be used to test a linear and non-linear (c.f. quadratic) relationship between situational and dispositional anthropomorphism and Theory-of-Mind. The following two models will be specified to test the main hypotheses:

## 7.1 Model 1 

Test the relationship between situational and dispositional anthropomorphism and effectance:
```{r}
priors1 <- c(set_prior("normal(0,1)", class = "b"))

brm(formula = cent_effectance ~ cent_sitant + cent_sitant2 + cent_disant + cent_disant2, 
      data = DF.exp2,
      family = gaussian,
      priors = priors1,
      chains = 4,
      iter = 4000,
      seed = 42, 
      file = model1ef.RDS)
```

## 7.2 Model 2 

Test the relationship between situational and dispositional anthropomorphism and false belief:
```{r}
brm(formula = cent_falsebelief ~ cent_sitant + cent_sitant2 + cent_disant + cent_disant2, 
      data = DF.exp2,
      family = gaussian,
      priors = priors1,
      chains = 4,
      iter = 4000,
      seed = 42, 
      file = model2fb.RDS)
```


False belief analysis {.tabset .tabset-fade .tabset-pills}
# 8. False belief:

```{r}
fb_summary <- summarySEwithin(DF.fa, measurevar="acc", withinvars= "p_b", idvar="prolific_id", na.rm=TRUE)

fb1 <- DF.fa %>%
  dplyr::group_by(prolific_id, p_b) %>%
  dplyr::summarise(acc = mean(acc)) %>%
  ggplot(., aes(x=p_b, y=acc, fill = p_b)) +
  geom_point(aes(colour = p_b), position=position_jitter(width = .05), size = 1, shape = 21, colour = "Black") +
  geom_flat_violin(position=position_nudge(x = .2, y = 0),adjust =2, trim = TRUE, alpha = .75, colour = "Black") +
  geom_boxplot(aes(x=p_b,y=acc),position=position_nudge(x = .1, y = 0),outlier.shape = NA, alpha = .5, width = .1, colour = "black") +
  geom_point(data = fb_summary, aes(x = p_b, y = acc, fill = p_b), position = position_nudge(.3), colour = "BLACK")+
  geom_errorbar(data = fb_summary, aes(x=p_b,y=acc, ymin = acc-ci, ymax = acc +ci), position=position_nudge(x = .3, y = 0), width = .05)+
    ylab("accuracy (p)")+
  xlab("belief (b) or photograph (p)") +
  scale_fill_manual(values=c("#0072B2", "#D55E00")) +
  theme(legend.position="none") 
```

```{r}
fb2 <- DF.fa %>%
  dplyr::group_by(prolific_id, p_b) %>%
  dplyr::summarise(rt = mean(rt)) %>%
  ggplot(., aes(x=p_b, y=rt, fill = p_b)) +
  geom_point(aes(colour = p_b), position=position_jitter(width = .05), size = 1, shape = 21, colour = "Black") +
  geom_flat_violin(position=position_nudge(x = .2, y = 0),adjust =2, trim = FALSE, alpha = .75, colour = "Black") +
  geom_boxplot(aes(x=p_b,y=rt),position=position_nudge(x = .1, y = 0),outlier.shape = NA, alpha = .5, width = .1, colour = "black") +
  ylab("reaction times (s)")+
  xlab("belief (b) or photograph (p)") +
  scale_fill_manual(values=c("#0072B2", "#D55E00")) +
  theme(legend.position="none") +
  ylim(0,6)
```

```{r}
fb1 + fb2
```









